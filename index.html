<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æŠ½ç±¤è½‰ç›¤</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Noto Sans TC", system-ui;
  margin: 16px;
}
h1 { font-size: 20px; }
.card {
  border: 1px solid #ddd;
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 16px;
}
label {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
}
button {
  padding: 10px 16px;
  border-radius: 10px;
  border: 1px solid #000;
  background: #fff;
  font-weight: bold;
}
canvas {
  width: 100%;
  max-width: 360px;
  aspect-ratio: 1/1;
  border-radius: 50%;
  border: 1px solid #ccc;
}
.result {
  font-size: 18px;
  font-weight: bold;
  margin-top: 10px;
}
</style>
</head>

<body>
<h1>ğŸ¯ æŠ½ç±¤è½‰ç›¤</h1>

<div class="card" id="list"></div>

<div class="card">
<canvas id="wheel" width="600" height="600"></canvas><br><br>
<button onclick="spin()">é–‹å§‹æŠ½</button>
<div class="result" id="result">å°šæœªæŠ½ç±¤</div>
</div>

<script>
const names = ["ç‰","å†°","éˆ","ç´…","è‘‰","ç™½","åº•","è±†","å®","7","å¤§é›„","Allen"];
let selected = new Set(names);
let excluded = new Set();

const list = document.getElementById("list");
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const result = document.getElementById("result");

function renderList(){
  list.innerHTML = "<b>åƒåŠ åå–®</b><br>";
  names.forEach(n=>{
    const label = document.createElement("label");
    const cb = document.createElement("input");
    cb.type="checkbox";
    cb.checked=selected.has(n);
    cb.onchange=()=>cb.checked?selected.add(n):selected.delete(n);
    label.appendChild(cb);
    label.appendChild(document.createTextNode(
      n + (excluded.has(n)?"ï¼ˆå·²æŠ½éï¼‰":"")
    ));
    list.appendChild(label);
  });
}

function pool(){
  return names.filter(n=>selected.has(n)&&!excluded.has(n));
}

function draw(){
  const p = pool();
  const N = p.length||1;
  const r = canvas.width/2;
  ctx.clearRect(0,0,600,600);
  ctx.save();
  ctx.translate(r,r);
  const slice = Math.PI*2/N;
  for(let i=0;i<N;i++){
    ctx.fillStyle=i%2?"#eee":"#ddd";
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,r-10,i*slice,(i+1)*slice);
    ctx.fill();
    ctx.save();
    ctx.rotate(i*slice+slice/2);
    ctx.textAlign="right";
    ctx.font="24px system-ui";
    ctx.fillStyle="#000";
    ctx.fillText(p[i], r-20, 8);
    ctx.restore();
  }
  ctx.restore();
}

function spin(){
  const p = pool();
  if(!p.length){ result.textContent="æ²’äººå¯æŠ½"; return;}
  const pick=p[Math.floor(Math.random()*p.length)];
  excluded.add(pick);
  result.textContent="ğŸ‰ æŠ½åˆ°ï¼š"+pick;
  renderList(); draw();
}

renderList(); draw();
</script>
</body>
</html>
